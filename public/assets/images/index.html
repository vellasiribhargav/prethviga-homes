<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Text Tools: Voice Over ¬∑ Re-write ¬∑ Translate</title>

  <style>
    :root{
      --bg: #0f172a;            /* slate-900 */
      --panel: #111827;         /* gray-900 */
      --muted: #9ca3af;         /* gray-400 */
      --accent: #6366f1;        /* indigo-500 */
      --accent-2: #22c55e;      /* green-500 */
      --accent-3: #f59e0b;      /* amber-500 */
      --text: #f9fafb;          /* gray-50 */
      --border: #1f2937;        /* gray-800 */
      --danger: #ef4444;
    }

    * { box-sizing: border-box; }
    html, body {
      margin: 0;
      padding: 0;
      background: radial-gradient(1200px 600px at 20% 0%, #111827 0%, #0f172a 45%, #0b1020 100%);
      color: var(--text);
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
      min-height: 100vh;
    }

    .container {
      max-width: 980px;
      margin: 0 auto;
      padding: 24px;
    }

    header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 24px;
    }
    .logo {
      width: 40px; height: 40px;
      display: grid; place-items: center;
      border-radius: 10px;
      background: linear-gradient(135deg, var(--accent), #7c3aed);
      box-shadow: 0 10px 30px rgba(99,102,241,.3);
      font-weight: 700;
    }
    h1 { font-size: 1.6rem; margin: 0; }
    .sub { color: var(--muted); font-size: .95rem; }

    .panel {
      background: rgba(17,24,39,.6);
      border: 1px solid var(--border);
      border-radius: 16px;
      padding: 16px;
      backdrop-filter: blur(8px);
      box-shadow: 0 15px 40px rgba(0,0,0,.35);
    }

    .input-area {
      display: grid;
      gap: 12px;
    }
    textarea {
      width: 100%;
      min-height: 160px;
      resize: vertical;
      padding: 14px 16px;
      border-radius: 12px;
      border: 1px solid var(--border);
      background: #0b1224;
      color: var(--text);
      font-size: 1rem;
      line-height: 1.5;
      outline: none;
      transition: border-color .15s ease, box-shadow .15s ease;
    }
    textarea::placeholder { color: #6b7280; }
    textarea:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(99,102,241,.2);
    }

    .actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      border: 1px solid var(--border);
      background: #0b1224;
      color: var(--text);
      padding: 10px 14px;
      border-radius: 12px;
      cursor: pointer;
      transition: transform .08s ease, box-shadow .15s ease, border-color .15s ease;
      user-select: none;
    }
    .btn:hover { transform: translateY(-1px); border-color: #334155; }
    .btn:active { transform: translateY(0); }
    .btn .icon { font-size: 1.1rem; }
    .btn.accent { background: linear-gradient(135deg, #111827 0, #0b1224 50%, #0f172a 100%); border-color: #334155; }
    .btn.voice { border-color: #3b82f6; }
    .btn.rewrite { border-color: var(--accent-2); }
    .btn.translate { border-color: var(--accent-3); }

    .inline-controls {
      display: grid;
      grid-template-columns: 1fr;
      gap: 10px;
      margin-top: 10px;
    }
    .row {
      display: flex; flex-wrap: wrap; gap: 10px; align-items: center;
    }
    .select, .range, .small-btn, .copy-btn {
      height: 40px;
      background: #0b1224;
      border: 1px solid var(--border);
      color: var(--text);
      border-radius: 10px;
      padding: 8px 12px;
      outline: none;
    }
    .select { min-width: 220px; }
    .range { width: 160px; }
    .small-btn, .copy-btn {
      display: inline-flex; align-items: center; gap: 6px; cursor: pointer;
    }
    .small-btn:hover, .copy-btn:hover { border-color: #334155; }

    .output {
      margin-top: 18px;
      background: #0b1224;
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 12px;
    }
    .output-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 8px;
      color: var(--muted);
      font-size: .95rem;
    }
    .output-content {
      white-space: pre-wrap;
      color: var(--text);
      font-size: 1rem;
      line-height: 1.55;
      min-height: 60px;
    }

    footer {
      margin-top: 24px;
      color: var(--muted);
      font-size: .9rem;
      text-align: center;
    }

    @media (max-width: 640px) {
      .select { min-width: unset; width: 100%; }
      .range { width: 100%; }
      .actions { gap: 8px; }
    }

    /* Tooltip (simple) */
    .btn[title] { position: relative; }
    .btn[title]:hover::after {
      content: attr(title);
      position: absolute;
      top: calc(100% + 8px); left: 0;
      background: #111827; border: 1px solid #334155; color: #e5e7eb;
      padding: 6px 8px; border-radius: 8px; font-size: .85rem; white-space: nowrap;
      box-shadow: 0 8px 24px rgba(0,0,0,.35);
      z-index: 10;
    }
  </style>
</head>
<body>
  <div class="container">
    <header aria-label="App header">
      <div class="logo" aria-hidden="true">TT</div>
      <div>
        <h1>Text Tools</h1>
        <div class="sub">Input box with Voice Over ¬∑ Re-write ¬∑ Translate</div>
      </div>
    </header>

    <section class="panel input-area" aria-label="Text input and actions">
      <label for="inputText" class="sr-only">Enter your text</label>
      <textarea id="inputText" placeholder="Enter your text here..."></textarea>

      <div class="actions" role="group" aria-label="Primary actions">
        <button class="btn voice" id="btnVoice" title="Generate audio narration of your text">
          <span class="icon">üé§</span> Voice Over
        </button>
        <button class="btn rewrite" id="btnRewrite" title="Get a rewritten version of your text">
          <span class="icon">‚úèÔ∏è</span> Re-write
        </button>
        <button class="btn translate" id="btnTranslate" title="Translate your text to another language">
          <span class="icon">üåê</span> Translate
        </button>
        <button class="btn accent" id="btnClear" title="Clear input and output">
          <span class="icon">üßπ</span> Clear
        </button>
      </div>

      <!-- Inline controls (shown dynamically) -->
      <div class="inline-controls" id="voiceControls" hidden>
        <div class="row">
          <select id="voiceSelect" class="select" aria-label="Voice">
            <option value="">Default voice</option>
          </select>
          <label>
            Rate
            <input id="rateRange" class="range" type="range" min="0.5" max="1.5" step="0.05" value="1" />
          </label>
          <label>
            Pitch
            <input id="pitchRange" class="range" type="range" min="0" max="2" step="0.05" value="1" />
          </label>
          <button class="small-btn" id="btnStopVoice"><span>‚èπÔ∏è</span> Stop</button>
        </div>
      </div>

      <div class="inline-controls" id="translateControls" hidden>
        <div class="row">
          <select id="langSelect" class="select" aria-label="Target language">
            <option value="en">English</option>
            <option value="ta">Tamil (‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç)</option>
            <option value="hi">Hindi (‡§π‡§ø‡§®‡•ç‡§¶‡•Ä)</option>
            <option value="es">Spanish (Espa√±ol)</option>
            <option value="fr">French (Fran√ßais)</option>
            <option value="de">German (Deutsch)</option>
            <option value="ar">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
            <option value="zh">Chinese (‰∏≠Êñá)</option>
            <option value="ja">Japanese (Êó•Êú¨Ë™û)</option>
          </select>
          <button class="small-btn" id="btnDoTranslate"><span>üöÄ</span> Translate Now</button>
        </div>
      </div>

      <div class="output" aria-live="polite">
        <div class="output-header">
          <span id="outputLabel">Output</span>
          <div>
            <button class="copy-btn" id="btnCopy"><span>üìã</span> Copy</button>
          </div>
        </div>
        <div id="outputContent" class="output-content"></div>
      </div>
    </section>

    <footer>
      <div>Tip: Use Voice Over for quick previews. Re-write refines style. Translate uses a demo dictionary; integrate your API for production.</div>
    </footer>
  </div>

  <script>
    // --- Elements ---
    const inputEl = document.getElementById('inputText');
    const outputEl = document.getElementById('outputContent');
    const outputLabelEl = document.getElementById('outputLabel');

    const btnVoice = document.getElementById('btnVoice');
    const btnRewrite = document.getElementById('btnRewrite');
    const btnTranslate = document.getElementById('btnTranslate');
    const btnClear = document.getElementById('btnClear');

    const voiceControls = document.getElementById('voiceControls');
    const voiceSelect = document.getElementById('voiceSelect');
    const rateRange = document.getElementById('rateRange');
    const pitchRange = document.getElementById('pitchRange');
    const btnStopVoice = document.getElementById('btnStopVoice');

    const translateControls = document.getElementById('translateControls');
    const langSelect = document.getElementById('langSelect');
    const btnDoTranslate = document.getElementById('btnDoTranslate');

    const btnCopy = document.getElementById('btnCopy');

    // --- Utility ---
    const setOutput = (text, label='Output') => {
      outputEl.textContent = text || '';
      outputLabelEl.textContent = label;
    };
    const getText = () => (inputEl.value || '').trim();

    // --- Clear ---
    btnClear.addEventListener('click', () => {
      inputEl.value = '';
      setOutput('', 'Output');
      voiceControls.hidden = true;
      translateControls.hidden = true;
      speechSynthesis.cancel();
    });

    // --- Copy output ---
    btnCopy.addEventListener('click', async () => {
      const text = outputEl.textContent;
      if (!text) return;
      try {
        await navigator.clipboard.writeText(text);
        btnCopy.textContent = '‚úÖ Copied';
        setTimeout(() => (btnCopy.innerHTML = '<span>üìã</span> Copy'), 1200);
      } catch {
        alert('Copy failed. Your browser may block clipboard access.');
      }
    });

    // ========== Voice Over ==========
    const populateVoices = () => {
      const voices = speechSynthesis.getVoices();
      voiceSelect.innerHTML = '<option value="">Default voice</option>';
      voices.forEach((v, idx) => {
        const opt = document.createElement('option');
        opt.value = v.name;
        opt.textContent = `${v.name} (${v.lang})`;
        voiceSelect.appendChild(opt);
      });
    };

    if ('speechSynthesis' in window) {
      populateVoices();
      window.speechSynthesis.onvoiceschanged = populateVoices;
    }

    btnVoice.addEventListener('click', () => {
      const text = getText();
      if (!text) return alert('Please enter some text to speak.');
      voiceControls.hidden = false;
      translateControls.hidden = true;

      const utter = new SpeechSynthesisUtterance(text);
      const selected = voiceSelect.value;
      const voices = speechSynthesis.getVoices();
      if (selected) {
        const match = voices.find(v => v.name === selected);
        if (match) utter.voice = match;
      }
      utter.rate = parseFloat(rateRange.value) || 1;
      utter.pitch = parseFloat(pitchRange.value) || 1;

      speechSynthesis.cancel(); // reset any ongoing speech
      speechSynthesis.speak(utter);
      setOutput('üîä Speaking‚Ä¶ (check your system volume)', 'Voice Over');
    });

    btnStopVoice.addEventListener('click', () => {
      speechSynthesis.cancel();
      setOutput('‚èπÔ∏è Voice stopped.', 'Voice Over');
    });

    // Update on slider changes if speaking
    [rateRange, pitchRange, voiceSelect].forEach(el => {
      el.addEventListener('input', () => {
        if (speechSynthesis.speaking) {
          speechSynthesis.cancel();
          btnVoice.click(); // restart with new settings
        }
      });
    });

    // ========== Re-write ==========
    // Note: Simple client-side heuristics; replace with your ML/NLP pipeline as needed.
    const rewriteText = (raw) => {
      let text = raw.trim();

      // Normalize whitespace
      text = text.replace(/\s+/g, ' ');

      // Sentence split (simple)
      const sentences = text
        .match(/[^.!?]+[.!?]?/g) || [text];

      const improved = sentences.map(s => {
        let t = s.trim();

        // Fix casing: capitalize first letter if most of text is lowercase
        t = t.charAt(0).toUpperCase() + t.slice(1);

        // Remove excessive exclamation marks
        t = t.replace(/!{2,}/g, '!');

        // Light shorten: if sentence > 140 chars, attempt to remove filler words
        if (t.length > 140) {
          t = t
            .replace(/\b(really|very|actually|basically|literally|just|quite|that|then|so)\b/gi, '')
            .replace(/\s{2,}/g, ' ')
            .trim();
        }
        // Prefer active tone: small replacements (demo)
        t = t.replace(/\bthere is\b/gi, 'there\'s')
             .replace(/\bit is\b/gi, 'it\'s');
        return t;
      });

      // Join with single spaces, ensure final punctuation
      let result = improved.join(' ').replace(/\s{2,}/g, ' ').trim();
      if (!/[.!?]$/.test(result)) result += '.';
      return result;
    };

    btnRewrite.addEventListener('click', () => {
      const text = getText();
      if (!text) return alert('Please enter some text to re-write.');
      const rewritten = rewriteText(text);
      translateControls.hidden = true;
      voiceControls.hidden = true;
      setOutput(rewritten, 'Re-written');
    });

    // ========== Translate ==========
    // Demo dictionary (extend or replace with API)
    const DICT = {
      'hello': { ta: '‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç', hi: '‡§®‡§Æ‡§∏‡•ç‡§§‡•á', es: 'hola', fr: 'bonjour', de: 'hallo', ar: 'ŸÖÿ±ÿ≠ÿ®ÿß', zh: '‰Ω†Â•Ω', ja: '„Åì„Çì„Å´„Å°„ÅØ' },
      'thank you': { ta: '‡Æ®‡Æ©‡Øç‡Æ±‡Æø', hi: '‡§ß‡§®‡•ç‡§Ø‡§µ‡§æ‡§¶', es: 'gracias', fr: 'merci', de: 'danke', ar: 'ÿ¥ŸÉÿ±ÿß', zh: 'Ë∞¢Ë∞¢', ja: '„ÅÇ„Çä„Åå„Å®„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô' },
      'good morning': { ta: '‡Æï‡Ææ‡Æ≤‡Øà ‡Æµ‡Æ£‡Æï‡Øç‡Æï‡ÆÆ‡Øç', hi: '‡§∏‡•Å‡§™‡•ç‡§∞‡§≠‡§æ‡§§', es: 'buenos d√≠as', fr: 'bonjour', de: 'guten Morgen', ar: 'ÿµÿ®ÿßÿ≠ ÿßŸÑÿÆŸäÿ±', zh: 'Êó©‰∏äÂ•Ω', ja: '„Åä„ÅØ„Çà„ÅÜ„Åî„Åñ„ÅÑ„Åæ„Åô' },
      'good night': { ta: '‡Æá‡Æ©‡Æø‡ÆØ ‡Æá‡Æ∞‡Æµ‡ØÅ', hi: '‡§∂‡•Å‡§≠ ‡§∞‡§æ‡§§‡•ç‡§∞‡§ø', es: 'buenas noches', fr: 'bonne nuit', de: 'gute Nacht', ar: 'ÿ™ÿµÿ®ÿ≠ ÿπŸÑŸâ ÿÆŸäÿ±', zh: 'ÊôöÂÆâ', ja: '„Åä„ÇÑ„Åô„Åø„Å™„Åï„ÅÑ' },
      'how are you': { ta: '‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æé‡Æ™‡Øç‡Æ™‡Æü‡Æø ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç?', hi: '‡§Ü‡§™ ‡§ï‡•à‡§∏‡•á ‡§π‡•à‡§Ç?', es: '¬øC√≥mo est√°s?', fr: 'Comment √ßa va ?', de: 'Wie geht es dir?', ar: 'ŸÉŸäŸÅ ÿ≠ÿßŸÑŸÉÿü', zh: '‰Ω†Â•ΩÂêóÔºü', ja: '„ÅäÂÖÉÊ∞ó„Åß„Åô„ÅãÔºü' }
    };

    const translateTextDemo = (raw, target) => {
      // Lowercase and trim for matching; split by sentences/phrases
      const text = raw.trim();
      const phrases = text.toLowerCase().match(/[^.!?]+[.!?]?/g) || [text.toLowerCase()];

      const translated = phrases.map(p => {
        const key = p.replace(/[.!?]/g, '').trim();
        const entry = DICT[key];
        if (entry && entry[target]) {
          return entry[target];
        }
        // Fallback: annotate rather than fake translate
        return `[${key}]`;
      });

      return translated.join(' ').trim();
    };

    btnTranslate.addEventListener('click', () => {
      const text = getText();
      if (!text) return alert('Please enter some text to translate.');
      translateControls.hidden = false;
      voiceControls.hidden = true;
      setOutput('Choose a target language and click ‚ÄúTranslate Now‚Äù.', 'Translate');
    });

    btnDoTranslate.addEventListener('click', () => {
      const text = getText();
      if (!text) return alert('Please enter some text to translate.');
      const target = langSelect.value;
      if (target === 'en') {
        setOutput(text, 'Translate ‚Üí English');
        return;
      }
      const result = translateTextDemo(text, target);
      setOutput(result, `Translate ‚Üí ${langSelect.options[langSelect.selectedIndex].text}`);
    });

    // Accessibility: announce changes for screen readers
    const announce = (msg) => {
      const live = document.createElement('div');
      live.setAttribute('aria-live', 'assertive');
      live.style.position = 'absolute';
      live.style.left = '-9999px';
      live.textContent = msg;
      document.body.appendChild(live);
      setTimeout(() => document.body.removeChild(live), 1000);
    };

    // Announce on key actions
    ['click'].forEach(evt => {
      btnVoice.addEventListener(evt, () => announce('Voice over started'));
      btnRewrite.addEventListener(evt, () => announce('Text re-written'));
      btnTranslate.addEventListener(evt, () => announce('Translate options shown'));
      btnClear.addEventListener(evt, () => announce('Cleared'));
    });
  </script>
</body>
</html>